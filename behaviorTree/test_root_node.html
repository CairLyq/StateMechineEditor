<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ROOTèŠ‚ç‚¹æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f0f0f0;
        }
        .test-result {
            padding: 10px;
            margin: 5px 0;
            border-radius: 4px;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <h1>ROOTèŠ‚ç‚¹æµ‹è¯•</h1>
    <div id="results"></div>

    <!-- åŠ è½½æ‰€æœ‰å¿…éœ€çš„è„šæœ¬ -->
    <script src="nodes/BaseNode.js"></script>
    <script src="nodes/RootNode.js"></script>
    <script src="nodes/SelectorNode.js"></script>
    <script src="nodes/SequenceNode.js"></script>
    <script src="nodes/ParallelNode.js"></script>
    <script src="nodes/InverterNode.js"></script>
    <script src="nodes/RepeaterNode.js"></script>
    <script src="nodes/ActionNode.js"></script>
    <script src="nodes/ConditionNode.js"></script>
    <script src="nodes/NodeFactory.js"></script>
    <script src="nodes/index.js"></script>

    <script>
        function addResult(message, type = 'success') {
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.textContent = message;
            document.getElementById('results').appendChild(div);
        }

        function runTests() {
            try {
                // æµ‹è¯• NodeFactory åˆ›å»º ROOT èŠ‚ç‚¹
                const factory = new NodeFactory();
                const rootNode = factory.createNode(NodeType.ROOT);
                
                if (rootNode && rootNode.type === NodeType.ROOT) {
                    addResult('âœ“ ROOTèŠ‚ç‚¹åˆ›å»ºæˆåŠŸ', 'success');
                } else {
                    addResult('âŒ ROOTèŠ‚ç‚¹åˆ›å»ºå¤±è´¥', 'error');
                    return;
                }
                
                // æµ‹è¯• ROOT èŠ‚ç‚¹å±æ€§
                if (rootNode.name.includes('æ ¹èŠ‚ç‚¹')) {
                    addResult('âœ“ ROOTèŠ‚ç‚¹åç§°æ­£ç¡®', 'success');
                } else {
                    addResult('âŒ ROOTèŠ‚ç‚¹åç§°é”™è¯¯: ' + rootNode.name, 'error');
                }
                
                // æµ‹è¯• ROOT èŠ‚ç‚¹æ˜¯å¦å¯ä»¥æœ‰å­èŠ‚ç‚¹
                if (rootNode.canHaveChildren()) {
                    addResult('âœ“ ROOTèŠ‚ç‚¹å¯ä»¥æœ‰å­èŠ‚ç‚¹', 'success');
                } else {
                    addResult('âŒ ROOTèŠ‚ç‚¹ä¸èƒ½æœ‰å­èŠ‚ç‚¹', 'error');
                }
                
                // æµ‹è¯•æ·»åŠ å­èŠ‚ç‚¹
                const selectorNode = factory.createNode(NodeType.SELECTOR);
                rootNode.addChild(selectorNode);
                
                if (rootNode.children.length === 1) {
                    addResult('âœ“ æˆåŠŸä¸ºROOTèŠ‚ç‚¹æ·»åŠ å­èŠ‚ç‚¹', 'success');
                } else {
                    addResult('âŒ æ·»åŠ å­èŠ‚ç‚¹å¤±è´¥', 'error');
                }
                
                // æµ‹è¯• ROOT èŠ‚ç‚¹æ‰§è¡Œ
                const status = rootNode.execute();
                if (status) {
                    addResult('âœ“ ROOTèŠ‚ç‚¹æ‰§è¡ŒæˆåŠŸï¼ŒçŠ¶æ€: ' + status, 'success');
                } else {
                    addResult('âŒ ROOTèŠ‚ç‚¹æ‰§è¡Œå¤±è´¥', 'error');
                }
                
                // æµ‹è¯• ROOT èŠ‚ç‚¹å±æ€§é…ç½®
                const config = rootNode.getPropertyConfig();
                if (config && config.length > 0) {
                    addResult(`âœ“ ROOTèŠ‚ç‚¹å±æ€§é…ç½®æˆåŠŸï¼Œå…±${config.length}ä¸ªå±æ€§`, 'success');
                } else {
                    addResult('âŒ ROOTèŠ‚ç‚¹å±æ€§é…ç½®å¤±è´¥', 'error');
                }
                
                // æµ‹è¯• ROOT èŠ‚ç‚¹éªŒè¯
                const errors = rootNode.validate();
                if (Array.isArray(errors)) {
                    addResult(`âœ“ ROOTèŠ‚ç‚¹éªŒè¯æˆåŠŸï¼Œé”™è¯¯æ•°: ${errors.length}`, 'success');
                } else {
                    addResult('âŒ ROOTèŠ‚ç‚¹éªŒè¯å¤±è´¥', 'error');
                }
                
                addResult('ğŸ‰ æ‰€æœ‰æµ‹è¯•å®Œæˆï¼', 'success');
                
            } catch (error) {
                addResult('âŒ æµ‹è¯•è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯: ' + error.message, 'error');
                console.error('æµ‹è¯•é”™è¯¯:', error);
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆåè¿è¡Œæµ‹è¯•
        window.addEventListener('load', () => {
            setTimeout(runTests, 100); // ç¨å¾®å»¶è¿Ÿç¡®ä¿æ‰€æœ‰è„šæœ¬åŠ è½½å®Œæˆ
        });
    </script>
</body>
</html> 